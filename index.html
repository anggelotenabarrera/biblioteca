<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title><?=content ?></title>
  </head>
  <body>
    <h1><?=content ?></h1>
    <div id="output"></div>
    <form id="myForm" action="https://script.google.com/macros/s/AKfycbwthbShiHRakkB59LwUqgJOekcgyjDxjE6yH7dIV0xB8TpbhZhjHEJhvJwNLDhaBH7R/exec" method="POST" enctype="multipart/form-data">

    <input type="type" name="first" id="first" placeholder="Nombre de archivo">
    <input type="file" name="myImage" multiple>
    <input type="button" id="subButton" value="Enviar">
    </form>
    <script>
      const output = document.getElementById('output');
      const first = document.getElementById('first');
      document.getElementById('subButton').addEventListener('click', function(e){
        e.preventDefault();
        output.innerHTML = first.value;
        google.script.run.withSuccessHandler(onSuccess).doUpload(this.parentNode)
      })
      function onSuccess(data){
        if(data.status){
          output.innerHTML = 'Archivo cargado con Ã©xito <br> <a href="'+data.url+'"target="_blank">'+data.url+'</a>';
        }
      }
    </script>
  </body>
</html>

